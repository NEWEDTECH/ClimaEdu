# Bounded Context: Reports

## Context Explanation

The **Reports** bounded context is responsible for generating analytical views, summaries, and detailed performance metrics across the platform using the **CQRS (Command Query Responsibility Segregation)** pattern.

Reports provide different types of insights depending on the persona accessing them:

- **Students** track their personal progress and achievements.
- **Tutors** monitor the performance of students under their responsibility.
- **Administrators** oversee the operational and educational success of their institution.

Reports are strictly **read-only representations** and do not modify underlying data.  
They are generated by aggregating data from multiple bounded contexts through direct repository queries.

## Architecture Pattern: CQRS

Instead of complex entities, reports use:
- **Use Cases** that query repositories directly
- **Output DTOs** that represent formatted data
- **Repository aggregation** for cross-domain data collection
- **Dependency Injection** for repository access

## User Role Identification

User roles are determined through relationship entities:
- **Enrollment**: Associates students with courses
- **UserInstitution**: Associates administrators with institutions  
- **CourseTutor**: Associates tutors with courses

---

## Available Reports by Persona

### üéì **STUDENT REPORTS (5 reports)**

| Report | Description | Data Sources |
|:-------|:------------|:-------------|
| **Student Course Progress** | % completion, last access, pending lessons | Enrollment, LessonProgress, Course |
| **Student Assessment Performance** | Scores per questionnaire, attempts, pass/fail | QuestionnaireSubmission |
| **Student Certificates** | Earned certificates with dates and downloads | Certificate |
| **Student Study Habits** | Access patterns, time spent, frequency | LessonProgress, ContentProgress |
| **Student Badges** | Earned badges and progress to next achievements | StudentBadge, Badge |

### üë®‚Äçüè´ **TUTOR REPORTS (4 reports)**

| Report | Description | Data Sources |
|:-------|:------------|:-------------|
| **Class Overview** | Active students, average progress, alerts | Class, Enrollment, LessonProgress |
| **Individual Student Tracking** | Detailed progress per student | User, LessonProgress, QuestionnaireSubmission |
| **Class Assessment Performance** | Questionnaire results for the class | QuestionnaireSubmission, Class |
| **Student Engagement & Retention** | At-risk students identification | Enrollment, LessonProgress |

### üè´ **INSTITUTION REPORTS (5 reports)**

| Report | Description | Data Sources |
|:-------|:------------|:-------------|
| **Course Dashboard** | Course status, enrollments, completions | Course, Class, Enrollment |
| **Retention Analysis** | Dropout rates, critical points | Enrollment, LessonProgress |
| **General Engagement** | Usage patterns, devices, schedules | LessonProgress, ContentProgress |
| **Educational Performance** | Average scores, completion times | QuestionnaireSubmission, LessonProgress |
| **Tutor Performance** | Effectiveness per tutor | CourseTutor, Class, QuestionnaireSubmission |

---

## Business Rules

- Reports must be **filtered by institution** to ensure tenant isolation
- **Role-based access control**:
  - **Students**: Only their own data
  - **Tutors**: Students in their assigned courses (via CourseTutor)
  - **Admins**: Institution-wide data (via UserInstitution)
- Reports are **generated in real-time** through direct repository queries
- All data must be **consistent** with underlying bounded contexts
- **CQRS pattern**: No entities, only use cases with repository aggregation

---

## Technical Implementation

### Use Case Pattern
```typescript
class GenerateStudentProgressReportUseCase {
  constructor(
    private enrollmentRepo: EnrollmentRepository,
    private lessonProgressRepo: LessonProgressRepository,
    private courseRepo: CourseRepository
  ) {}
  
  async execute(input: GenerateStudentProgressReportInput): Promise<StudentProgressReportOutput> {
    // Direct repository queries and data aggregation
  }
}
```

### Dependency Injection
All repositories are injected through the DI container using symbols for loose coupling.
